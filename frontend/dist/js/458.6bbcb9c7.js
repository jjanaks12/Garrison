"use strict";(self["webpackChunkrolenpermissionf"]=self["webpackChunkrolenpermissionf"]||[]).push([[458],{5810:function(e,t,r){var s=r(2482),i=r(9203),o=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let a=class extends i.w3{constructor(...e){super(...e),(0,s.Z)(this,"isFocus",!1),(0,s.Z)(this,"hasText",!1),(0,s.Z)(this,"title",void 0),(0,s.Z)(this,"disabled",void 0)}render(){const e=arguments[0];return e("div",{class:{form__group:!0,"has--text":this.isFocus||this.hasText}},[this.title?e("label",{attrs:{for:""}},[this.title]):null,this.$slots.default])}mounted(){const e=this.$el.querySelector("input");e&&(this.$nextTick((()=>{this.hasText=""!==e.value})),e.addEventListener("focus",(()=>{this.isFocus=!0})),e.addEventListener("blur",(()=>{this.isFocus=!1})),e.addEventListener("input",(()=>{this.hasText=e.value.length>0})),this.disabled&&e.setAttribute("disabled",""))}};o([(0,i.fI)({default:""})],a.prototype,"title",void 0),o([(0,i.fI)({default:!1})],a.prototype,"disabled",void 0),a=o([i.wA],a),t["Z"]=a},3958:function(e,t,r){var s=r(8701),i=r.n(s),o=r(2482),a=r(9203),l=r(5810),n=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let c,d=class extends a.w3{constructor(...e){super(...e),(0,o.Z)(this,"searchText","")}searchTextChanged(){c&&clearTimeout(c),c=setTimeout((()=>{this.submitHandler()}),300)}render(){const e=arguments[0];return e("form",{attrs:{action:"#",method:"POST"},class:"form form__inline p4 text--center",on:{submit:this.submitHandler}},[e(l.Z,[e("input",i()([{on:{input:e=>{e.target.composing||(this.searchText=e.target.value)}},attrs:{type:"search",name:"search_permission",id:"spf_search",placeholder:"Search text here..."},domProps:{value:this.searchText}},{directives:[{name:"model",value:this.searchText,modifiers:{}}]}]))]),e("div",{class:"form__action"},[e("button",{attrs:{type:"submit"},class:"btn btn__primary"},[e("span",{class:"material-icons"},["search"])])])])}submitHandler(e){e&&e.preventDefault(),this.$emit("search",this.searchText)}};n([(0,a.RL)("searchText")],d.prototype,"searchTextChanged",null),d=n([a.wA],d),t["Z"]=d},7682:function(e,t,r){var s=r(2482),i=r(9203),o=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let a=class extends i.w3{constructor(...e){super(...e),(0,s.Z)(this,"current",void 0),(0,s.Z)(this,"total",void 0),(0,s.Z)(this,"max",void 0)}get pages(){let e=this.max;e>this.total&&(e=this.total);let t=this.current-Math.floor(e/2);return t=Math.max(t,1),t=Math.min(t,1+this.total-e),Array.from({length:e},((e,r)=>t+r))}render(){const e=arguments[0];return e("nav",{class:"pagination"},[this.total>1?[e("ul",{class:"pagination__list"},[this.current>1?e("li",[e("a",{attrs:{href:"#"},class:"pagination--btn prev",on:{click:this.prev}},["prev"])]):null,this.pages.map((t=>e("li",[t===this.current?e("strong",[t]):e("a",{attrs:{href:"#"},on:{click:e=>{e.preventDefault(),this.goto(t)}}},[t])]))),this.current<this.total?e("li",[e("a",{attrs:{href:"#"},class:"pagination--btn next",on:{click:this.next}},["next"])]):null])]:null])}next(e){e.preventDefault(),this.$emit("next")}prev(e){e.preventDefault(),this.$emit("prev")}goto(e){this.$emit("goto",e)}};o([(0,i.fI)({required:!0})],a.prototype,"current",void 0),o([(0,i.fI)({required:!0})],a.prototype,"total",void 0),o([(0,i.fI)({default:3})],a.prototype,"max",void 0),a=o([i.wA],a),t["Z"]=a},5775:function(e,t,r){var s=r(9203),i=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let o=class extends s.w3{render(){const e=arguments[0];return e("div",{class:"skeleton__loader skeleton__loader--inline"},[e("div",{class:"wrap"},[e("span",{class:"text"})]),e("div",{class:"action"},[e("span",{class:"link"}),e("span",{class:"link"})])])}};o=i([s.wA],o),t["Z"]=o},1458:function(e,t,r){r.r(t),r.d(t,{default:function(){return P}});var s=r(2482),i=r(9203),o=r(3822),a=r(8701),l=r.n(a),n=r(5810),c=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let d=class extends i.w3{constructor(...e){super(...e),(0,s.Z)(this,"toggleModal",void 0),(0,s.Z)(this,"list",void 0),(0,s.Z)(this,"fetchRole",void 0),(0,s.Z)(this,"assignRole",void 0),(0,s.Z)(this,"role",""),(0,s.Z)(this,"userId",void 0),(0,s.Z)(this,"roleId",void 0)}async mounted(){await this.fetchRole({params:{per_page:null}}),this.role=this.roleId??""}get hasChanged(){return""===this.role||this.role!==this.roleId}render(){const e=arguments[0];return e("form",{class:"form",on:{submit:this.formSubmit}},[e(n.Z,[e("select",l()([{on:{change:e=>{const t=Array.prototype.filter.call(e.target.options,(e=>e.selected)).map((e=>"_value"in e?e._value:e.value));this.role=e.target.multiple?t:t[0]}}},{directives:[{name:"model",value:this.role,modifiers:{}}]}]),[e("option",{attrs:{value:""}},["Select an role"]),this.list.map((t=>e("option",{domProps:{selected:t.id===this.roleId,value:t.id}},[t.title])))])]),e("div",{class:"form__action"},[e("button",{attrs:{type:"submit",disabled:!this.hasChanged},class:"btn btn__primary"},["Save"])])])}formSubmit(e){e.preventDefault(),this.role&&this.assignRole({userID:this.userId,roleID:this.role}).then((()=>{this.toggleModal(null)}))}};c([(0,i.fI)({required:!0})],d.prototype,"userId",void 0),c([(0,i.fI)({default:null})],d.prototype,"roleId",void 0),d=c([(0,i.wA)({computed:{...(0,o.Se)({list:"role/list"})},methods:{...(0,o.nv)({toggleModal:"root/toggleModal",fetchRole:"role/fetch",assignRole:"user/assignRole"})}})],d);var h=d,u=r(8921),f=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let p=class extends i.w3{constructor(...e){super(...e),(0,s.Z)(this,"detail",void 0)}render(){const e=arguments[0];return e("dl",[e("dt",["Name:"]),e("dd",[this.detail.name]),e("dt",["Phone:"]),e("dd",[this.detail.phone]),e("dt",["email:"]),e("dd",[this.detail.email]),e("dt",["address:"]),e("dd",[this.detail.address])])}};f([(0,i.fI)({required:!0})],p.prototype,"detail",void 0),p=f([i.wA],p);var v=p,g=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let m=class extends i.w3{constructor(...e){super(...e),(0,s.Z)(this,"toggleModal",void 0),(0,s.Z)(this,"destory",void 0),(0,s.Z)(this,"myRole",void 0),(0,s.Z)(this,"hasHigherRole",!1),(0,s.Z)(this,"detail",void 0)}onMyRoleChanged(){this.init()}get roles(){return this.detail.roles?this.detail.roles.map((e=>e.title)).join(", "):""}get roleId(){return this.detail.roles&&this.detail.roles[0]?this.detail.roles[0].id??null:null}get abbr(){return this.detail.name?this.detail.name.split(" ").map((e=>e[0])).join(""):this.detail.email[0]}mounted(){this.init()}init(){if(this.detail.roles&&this.detail.roles.length>0){const e=this.detail.roles[0];void 0!==e.priority&&void 0!==this.myRole.priority&&(this.hasHigherRole=this.myRole.priority<e.priority)}}render(){const e=arguments[0];return e("div",{class:"item"},[e("figure",{class:"item__image"},[this.detail?.media?e("img",{attrs:{src:this.detail.media.url,alt:this.detail.name}}):e("span",[this.abbr])]),e("div",{class:"item__detail"},[e("h3",{class:"h6"},[u.Z.can("view_user","all")?e("a",{attrs:{href:"#"},on:{click:e=>{e.preventDefault(),this.toggleModal({title:`Detail of <strong>${this.detail.email}</strong>`,component:v,props:{detail:this.detail}})}}},[this.detail.name?this.detail.name:this.detail.email]):this.detail.email]),e("em",{class:"list__string"},[this.roles])]),e("div",{class:"item__action"},[!u.Z.can("change_role","all")||!this.hasHigherRole&&this.roleId?null:e("a",{attrs:{href:"#"},on:{click:e=>{e.preventDefault(),this.detail.id&&this.toggleModal({title:`<hi>Assign role to <strong>${this.detail.email}</strong></hi>`,component:h,props:{userId:this.detail.id,roleId:this.roleId}})}}},[this.detail.roles&&this.detail.roles.length>0?"Update role":"Assign role"]),u.Z.can("delete_user","all")&&this.hasHigherRole?e("a",{attrs:{href:"#"},on:{click:e=>{e.preventDefault(),this.detail.id&&this.destory(this.detail.id)}}},["delete"]):null])])}};g([(0,i.fI)({required:!0})],m.prototype,"detail",void 0),g([(0,i.RL)("myRole",{deep:!0})],m.prototype,"onMyRoleChanged",null),m=g([(0,i.wA)({computed:{...(0,o.Se)({myRole:"root/myRole"})},methods:{...(0,o.nv)({toggleModal:"root/toggleModal",destory:"user/destory"})}})],m);var y=m,b=r(3958),_=r(7682),R=r(5775),x=function(e,t,r,s){var i,o=arguments.length,a=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,s);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};let Z=class extends i.w3{constructor(...e){super(...e),(0,s.Z)(this,"isLoading",void 0),(0,s.Z)(this,"list",void 0),(0,s.Z)(this,"current",void 0),(0,s.Z)(this,"lastPage",void 0),(0,s.Z)(this,"fetch",void 0),(0,s.Z)(this,"search",void 0),(0,s.Z)(this,"prevPage",void 0),(0,s.Z)(this,"nextPage",void 0),(0,s.Z)(this,"goto",void 0)}mounted(){this.fetch({params:{per_page:10}})}render(){const e=arguments[0];return e("section",{class:"card"},[e("header",{class:"card__header"},[e("h1",{class:"card__title"},["Users"]),e("div",{class:"card__header__action"},[e("a",{attrs:{href:"#"},on:{click:e=>{e.preventDefault(),this.fetch({params:{per_page:10}})}}},[e("span",{class:"material-icons"},["refresh"])])])]),e("div",{class:"card__body"},[e(b.Z,{on:{search:e=>{this.search(e)}}}),this.isLoading?e(R.Z):this.list.map((t=>e(y,{attrs:{detail:t},key:t.id})))]),e("footer",{class:"card__footer"},[e(_.Z,{attrs:{current:this.current,total:this.lastPage},on:{next:()=>this.nextPage(),prev:()=>this.prevPage(),goto:e=>this.goto(e)}})])])}};Z=x([(0,i.wA)({computed:{...(0,o.Se)({list:"user/list",current:"user/currentPage",lastPage:"user/lastPage",isLoading:"user/isLoading"})},methods:{...(0,o.nv)({fetch:"user/fetch",nextPage:"user/nextPage",prevPage:"user/prevPage",goto:"user/gotoPage",search:"user/search"})}})],Z);var P=Z},8701:function(e){function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t,r=1;r<arguments.length;r++)for(var s in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},t.apply(this,arguments)}var r=["attrs","props","domProps"],s=["class","style","directives"],i=["on","nativeOn"],o=function(e){return e.reduce((function(e,o){for(var l in o)if(e[l])if(-1!==r.indexOf(l))e[l]=t({},e[l],o[l]);else if(-1!==s.indexOf(l)){var n=e[l]instanceof Array?e[l]:[e[l]],c=o[l]instanceof Array?o[l]:[o[l]];e[l]=[].concat(n,c)}else if(-1!==i.indexOf(l))for(var d in o[l])if(e[l][d]){var h=e[l][d]instanceof Array?e[l][d]:[e[l][d]],u=o[l][d]instanceof Array?o[l][d]:[o[l][d]];e[l][d]=[].concat(h,u)}else e[l][d]=o[l][d];else if("hook"===l)for(var f in o[l])e[l][f]=e[l][f]?a(e[l][f],o[l][f]):o[l][f];else e[l]=o[l];else e[l]=o[l];return e}),{})},a=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}};e.exports=o}}]);
//# sourceMappingURL=458.6bbcb9c7.js.map